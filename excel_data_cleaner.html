<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>Excel Data Cleaner</title>

<style>
    body {
        font-family: "Segoe UI", Arial, sans-serif;
        background: #eef1f5;
        padding: 40px;
    }

    .container {
        max-width: 900px;
        margin: auto;
        background: #ffffff;
        padding: 30px 40px;
        border-radius: 12px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.08);
    }

    h1 {
        margin-top: 0;
        color: #2c3e50;
        font-size: 28px;
    }

    p {
        color: #555;
        margin-bottom: 15px;
    }

    textarea {
        width: 100%;
        height: 200px;
        margin-top: 8px;
        font-size: 14px;
        padding: 12px;
        box-sizing: border-box;
        border-radius: 8px;
        border: 1px solid #ccc;
        resize: vertical;
    }

    textarea:focus {
        outline: none;
        border-color: #4a90e2;
        box-shadow: 0 0 0 2px rgba(74,144,226,0.2);
    }

    .btn {
        margin-top: 14px;
        margin-right: 10px;
        padding: 10px 22px;
        font-size: 15px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .btn-primary {
        background: #4a90e2;
        color: #fff;
    }

    .btn-primary:hover {
        background: #357abd;
    }

    .btn-secondary {
        background: #f1f3f6;
        color: #333;
    }

    .btn-secondary:hover {
        background: #e0e3e8;
    }

    .info {
        margin-top: 12px;
        color: #27ae60;
        font-weight: 500;
    }

    .page {
        display: none;
    }

    .page.active {
        display: block;
    }

    .section {
        margin-top: 25px;
    }

    .actions {
        margin-top: 15px;
    }
</style>
</head>

<body>

<div class="container">

<!-- ================= 4D PAGE ================= -->
<div id="page4d" class="page active">
    <h1>ğŸ§¹ Excel Data Cleaner â€“ 4D</h1>
    <p>è‡ªåŠ¨åˆ é™¤ <b>4 ä¸ªæ•°å­— + ##</b>ï¼ˆä¾‹å¦‚ï¼š1234##ï¼‰</p>

    <div class="section">
        <textarea id="input4d" placeholder="Paste Excel data here..."></textarea>
    </div>

    <div class="actions">
        <button class="btn btn-primary" onclick="clean4D()">âœ¨ å¼€å§‹æ¸…ç† (4D)</button>
    </div>

    <div class="info" id="info4d"></div>

    <div class="section">
        <textarea id="output4d" placeholder="æ¸…ç†åçš„ç»“æœ"></textarea>
    </div>

    <div class="actions">
        <button class="btn btn-secondary" onclick="copyData('output4d')">ğŸ“‹ Copy</button>
        <button class="btn btn-secondary" onclick="go3D()">â¡ï¸ åˆ‡æ¢åˆ° 3D</button>
    </div>
</div>

<!-- ================= 3D PAGE ================= -->
<div id="page3d" class="page">
    <h1>ğŸ§¹ Excel Data Cleaner â€“ 3D</h1>
    <p>è‡ªåŠ¨åˆ é™¤ <b>3 ä¸ªæ•°å­— + ##</b>ï¼ˆä¾‹å¦‚ï¼š123##ï¼‰</p>

    <div class="section">
        <textarea id="input3d" placeholder="Paste Excel data here..."></textarea>
    </div>

    <div class="actions">
        <button class="btn btn-primary" onclick="clean3D()">âœ¨ å¼€å§‹æ¸…ç† (3D)</button>
    </div>

    <div class="info" id="info3d"></div>

    <div class="section">
        <textarea id="output3d" placeholder="æ¸…ç†åçš„ç»“æœ"></textarea>
    </div>

    <div class="actions">
        <button class="btn btn-secondary" onclick="copyData('output3d')">ğŸ“‹ Copy</button>
        <button class="btn btn-secondary" onclick="go4D()">â¬…ï¸ åˆ‡æ¢åˆ° 4D</button>
    </div>
</div>

</div>

<script>
function go3D() {
    document.getElementById("page4d").classList.remove("active");
    document.getElementById("page3d").classList.add("active");
}

function go4D() {
    document.getElementById("page3d").classList.remove("active");
    document.getElementById("page4d").classList.add("active");
}

function clean4D() {
    processClean("input4d", "output4d", "info4d", /^\d{4}##/, "4D");
}

function clean3D() {
    processClean("input3d", "output3d", "info3d", /^\d{3}##/, "3D");
}

function processClean(inputId, outputId, infoId, regex, label) {
    const input = document.getElementById(inputId).value;
    const lines = input.split(/\r?\n/);
    let removed = 0;

    const cleaned = lines.filter(line => {
        if (regex.test(line.trim())) {
            removed++;
            return false;
        }
        return true;
    });

    document.getElementById(outputId).value = cleaned.join("\n");
    document.getElementById(infoId).innerText =
        `å®Œæˆï¼å·²åˆ é™¤ ${removed} è¡Œ (${label})`;
}

function copyData(outputId) {
    const textarea = document.getElementById(outputId);

    if (!textarea.value.trim()) {
        alert("æ²¡æœ‰å¯ä»¥å¤åˆ¶çš„æ•°æ®");
        return;
    }

    textarea.select();
    textarea.setSelectionRange(0, 99999);
    document.execCommand("copy");

    alert("âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼");
}
</script>

</body>
</html>
