<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Cleaner Pro - é»‘æ¡†ç¡¬æœ—ç‰ˆ</title>
    <style>
        :root {
            --primary: #000000; /* æ”¹ä¸ºçº¯é»‘ä¸»é¢˜ */
            --success: #22c55e;
            --danger: #ef4444;
            --glass-bg: #ffffff;
            --text-dark: #000000;
        }

        body {
            /* ä¿æŒç»šä¸½èƒŒæ™¯ï¼Œè¡¬æ‰˜ä¸­é—´çš„ç™½åº•é»‘æ¡† */
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #312e81 100%);
            background-attachment: fixed;
            font-family: 'Inter', -apple-system, sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* ç»ç’ƒæ‹Ÿæ€å®¹å™¨ + é»‘è‰²è¾¹æ¡† */
        .glass-container {
            width: 95%;
            max-width: 1100px;
            background: var(--glass-bg);
            border-radius: 24px;
            border: 2px solid #000000; /* å®¹å™¨é»‘è‰²è¾¹æ¡† */
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            padding: 40px;
            box-sizing: border-box;
            position: relative;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5rem;
            margin: 0;
            color: #000;
            font-weight: 800;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 850px) {
            .main-grid { grid-template-columns: 1fr; }
        }

        .panel {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .panel label {
            font-size: 1rem;
            font-weight: 800;
            color: #000;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* é‡ç‚¹ï¼šè¾“å…¥è¾“å‡ºæ¡†çš„é»‘è‰²ç²—è¾¹æ¡† */
        textarea {
            width: 100%;
            height: 400px;
            padding: 20px;
            border-radius: 16px;
            border: 2px solid #000000; /* é»‘è‰²å®å¿ƒè¾¹æ¡† */
            font-family: 'Consolas', monospace;
            font-size: 14px;
            line-height: 1.6;
            transition: all 0.2s;
            resize: none;
            box-sizing: border-box;
            background: #fff;
            color: #000;
        }

        textarea:focus {
            outline: none;
            box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.1); /* èšç„¦æ—¶æ·¡æ·¡çš„é»‘è‰²é˜´å½± */
        }

        /* æŒ‰é’®è®¾è®¡ */
        .controls {
            grid-column: 1 / -1;
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-top: 15px;
        }

        .btn {
            padding: 14px 28px;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 2px solid #000;
            font-size: 15px;
        }

        .btn-run {
            background: #000;
            color: white;
        }

        .btn-run:hover {
            background: #333;
            transform: translateY(-2px);
        }

        .btn-clear {
            background: white;
            color: #000;
        }

        .btn-clear:hover {
            background: #f0f0f0;
        }

        /* åº•éƒ¨æ“ä½œ */
        .footer-actions {
            margin-top: 30px;
            padding-top: 25px;
            border-top: 2px solid #000;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .btn-copy {
            background: var(--success);
            color: white;
            border: 2px solid #000;
            width: 100%;
            max-width: 400px;
            justify-content: center;
        }

        .btn-switch {
            background: #e2e8f0;
            color: #000;
            border: 2px solid #000;
        }

        .status-msg {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 700;
            display: none;
            border: 2px solid #000;
            background: #dcfce7; /* æˆåŠŸæç¤ºä¿æŒä¸€ç‚¹æµ…ç»¿ */
        }

        .page { display: none; }
        .page.active { display: block; }
    </style>
</head>
<body>

<div class="glass-container">
    <header>
        <h1 id="title-text">Excel Cleaner 4D</h1>
    </header>

    <div id="page4d" class="page active">
        <div class="main-grid">
            <div class="panel">
                <label>ğŸ“¥ åŸå§‹æ•°æ®</label>
                <textarea id="input4d"></textarea>
            </div>
            <div class="panel">
                <label>âœ… æ¸…ç†ç»“æœ</label>
                <textarea id="output4d" readonly></textarea>
            </div>
            <div class="controls">
                <button class="btn btn-run" onclick="runClean4D()">ğŸš€ å¼€å§‹æ¸…ç† (4D)</button>
                <button class="btn btn-clear" onclick="clearAll('input4d', 'output4d', 'info4d')">ğŸ—‘ï¸ å…¨éƒ¨æ¸…ç©º</button>
            </div>
        </div>
        <div class="footer-actions">
            <div id="info4d" class="status-msg"></div>
            <button class="btn btn-copy" onclick="doCopy('output4d')">ğŸ“‹ å¤åˆ¶æ¸…ç†ç»“æœ</button>
            <button class="btn btn-switch" onclick="toPage('page3d', '3D')">ğŸ”„ åˆ‡æ¢è‡³ 3D æ¨¡å¼</button>
        </div>
    </div>

    <div id="page3d" class="page">
        <div class="main-grid">
            <div class="panel">
                <label>ğŸ“¥ åŸå§‹æ•°æ®</label>
                <textarea id="input3d"></textarea>
            </div>
            <div class="panel">
                <label>âœ… æ¸…ç†ç»“æœ</label>
                <textarea id="output3d" readonly></textarea>
            </div>
            <div class="controls">
                <button class="btn btn-run" onclick="runClean3D()">ğŸš€ å¼€å§‹æ¸…ç† (3D)</button>
                <button class="btn btn-clear" onclick="clearAll('input3d', 'output3d', 'info3d')">ğŸ—‘ï¸ å…¨éƒ¨æ¸…ç©º</button>
            </div>
        </div>
        <div class="footer-actions">
            <div id="info3d" class="status-msg"></div>
            <button class="btn btn-copy" onclick="doCopy('output3d')">ğŸ“‹ å¤åˆ¶æ¸…ç†ç»“æœ</button>
            <button class="btn btn-switch" onclick="toPage('page4d', '4D')">ğŸ”„ åˆ‡æ¢è‡³ 4D æ¨¡å¼</button>
        </div>
    </div>
</div>

<script>
    function toPage(pageId, mode) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
        document.getElementById('title-text').innerText = `Excel Cleaner ${mode}`;
    }

    function runClean4D() { executeProcess("input4d", "output4d", "info4d", /^\d{4}##$/); }
    function runClean3D() { executeProcess("input3d", "output3d", "info3d", /^\d{3}##$/); }

    function executeProcess(inId, outId, infoId, rx) {
        const raw = document.getElementById(inId).value;
        if (!raw.trim()) return;

        const lines = raw.split(/\r?\n/);
        let removed = 0;
        const result = lines.filter(l => {
            if (rx.test(l.trim())) {
                removed++;
                return false;
            }
            return true;
        });

        document.getElementById(outId).value = result.join("\n");
        const info = document.getElementById(infoId);
        info.innerHTML = `ğŸŒŸ å¤„ç†å®Œæˆï¼å·²ç§»é™¤ <b>${removed}</b> è¡Œã€‚`;
        info.style.display = "block";
    }

    async function doCopy(id) {
        const content = document.getElementById(id).value;
        if (!content) return;
        try {
            await navigator.clipboard.writeText(content);
            alert("âœ… ç»“æœå·²å¤åˆ¶ï¼");
        } catch (e) {
            document.getElementById(id).select();
            document.execCommand('copy');
            alert("âœ… ç»“æœå·²å¤åˆ¶ï¼");
        }
    }

    function clearAll(i, o, inf) {
        document.getElementById(i).value = "";
        document.getElementById(o).value = "";
        document.getElementById(inf).style.display = "none";
    }
</script>

</body>
</html>
